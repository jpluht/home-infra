---
# Group variables for Cisco PoE switches
# 
# VLAN definitions and port mappings are loaded dynamically from vault-config.yml
# at playbook runtime (see automation/playbooks/poe_switches.yml)

# ====================================================================
# Cisco IOS Connection Defaults (same as core_switches)
# ====================================================================
ansible_connection: network_cli
ansible_network_os: cisco.ios.ios
ansible_become: yes
ansible_become_method: enable

# ====================================================================
# PoE Power Configuration
# ====================================================================
# PoE power budget is typically 370W (Catalyst 3750 PoE)
# Can be overridden per-device in inventory

poe_power_budget_watts: 370
poe_enable_backoff: yes
poe_backoff_delay: 100  # ms

# ====================================================================
# Access Port Defaults for PoE Devices
# ====================================================================
# Typical connected devices: IP cameras, wireless APs, VoIP phones
# These inherit access port configuration from vault-config

poe_device_class: "high-power"  # 30W max per port
poe_port_priority: "high"

# ====================================================================
# VLAN Trunk Configuration
# ====================================================================
# PoE switches typically trunk to core switches and OPNsense

trunk_ports_default:
  - "GigabitEthernet0/1"      # Trunk to core switch
  - "GigabitEthernet0/2"      # Backup trunk

# ====================================================================
# Port Security
# ====================================================================
port_security_enabled: yes
port_security_violation: "restrict"     # Use "restrict" for PoE to avoid power issues
port_security_max_addresses: 5
port_security_aging_time: 2  # minutes

# ====================================================================
# Spanning Tree
# ====================================================================
spanning_tree_mode: "pvst"
spanning_tree_bpdufilter_default: yes

# ====================================================================
# DHCP Snooping
# ====================================================================
dhcp_snooping_enabled: yes
dhcp_snooping_trust_ports:
  - "GigabitEthernet0/1"      # Trust uplinks
  - "GigabitEthernet0/2"

# ====================================================================
# Interface Speed & Duplex
# ====================================================================
interface_speed: "auto"
interface_duplex: "auto"

# ====================================================================
# Storm Control (prevent broadcast storms)
# ====================================================================
storm_control_enabled: yes
storm_control_broadcast_level: 15  # percent
storm_control_multicast_level: 15
storm_control_unicast_level: 15
